/**
 * Angularjs环境下分页
 * name: tm.pagination
 * Version: 1.0.0
 */angular.module("tm.pagination",[]).directive("tmPagination",[function(){return{restrict:"EA",template:'\x3cdiv class\x3d"page-list"\x3e\x3cul class\x3d"pagination" ng-show\x3d"conf.totalItems \x3e 0"\x3e\x3cli ng-class\x3d"{disabled: conf.currentPage \x3d\x3d 1}" ng-click\x3d"prevPage()"\x3e\x3cspan\x3e\x26laquo;\x3c/span\x3e\x3c/li\x3e\x3cli ng-repeat\x3d"item in pageList track by $index" ng-class\x3d"{active: item \x3d\x3d conf.currentPage, separate: item \x3d\x3d \'...\'}" ng-click\x3d"changeCurrentPage(item)"\x3e\x3cspan\x3e{{ item }}\x3c/span\x3e\x3c/li\x3e\x3cli ng-class\x3d"{disabled: conf.currentPage \x3d\x3d conf.numberOfPages}" ng-click\x3d"nextPage()"\x3e\x3cspan\x3e\x26raquo;\x3c/span\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d"page-total" ng-show\x3d"conf.totalItems \x3e 0"\x3e\u7b2c\x3cinput type\x3d"text" ng-model\x3d"jumpPageNum"  ng-keyup\x3d"jumpToPage($event)"/\x3e\u9875 \u6bcf\u9875\x3cselect ng-model\x3d"conf.itemsPerPage" ng-options\x3d"option for option in conf.perPageOptions " ng-change\x3d"changeItemsPerPage()"\x3e\x3c/select\x3e/\u5171\x3cstrong\x3e{{ conf.totalItems }}\x3c/strong\x3e\u6761\x3c/div\x3e\x3cdiv class\x3d"no-items" ng-show\x3d"conf.totalItems \x3c\x3d 0"\x3e\u6682\u65e0\u6570\u636e\x3c/div\x3e\x3c/div\x3e',replace:!0,scope:{conf:"\x3d"},link:function(a,e,f){a.changeCurrentPage=function(c){"..."!=c&&(a.conf.currentPage=c)};a.conf.pagesLength=parseInt(a.conf.pagesLength)?parseInt(a.conf.pagesLength):9;0===a.conf.pagesLength%2&&--a.conf.pagesLength;a.conf.perPageOptions||(a.conf.perPageOptions=[10,15,25,30,50]);a.prevPage=function(){1<a.conf.currentPage&&--a.conf.currentPage};a.nextPage=function(){a.conf.currentPage<a.conf.numberOfPages&&(a.conf.currentPage+=1)};a.jumpToPage=function(){a.jumpPageNum=a.jumpPageNum.replace(/[^0-9]/g,"");""!==a.jumpPageNum&&(a.conf.currentPage=a.jumpPageNum)};a.changeItemsPerPage=function(){a.conf.rememberPerPage&&localStorage.removeItem(a.conf.rememberPerPage)};a.$watch(function(){var c=a.conf.currentPage+" "+a.conf.totalItems+" ";return c=a.conf.rememberPerPage?localStorage[a.conf.rememberPerPage]?c+localStorage[a.conf.rememberPerPage]:c+a.conf.itemsPerPage:c+a.conf.itemsPerPage},function(){a.conf.currentPage=parseInt(a.conf.currentPage)?parseInt(a.conf.currentPage):1;a.conf.currentPage=0<a.conf.currentPage?a.conf.currentPage:1;a.conf.totalItems=parseInt(a.conf.totalItems);a.conf.rememberPerPage?(parseInt(localStorage[a.conf.rememberPerPage])||(localStorage[a.conf.rememberPerPage]=parseInt(a.conf.itemsPerPage)?parseInt(a.conf.itemsPerPage):15),a.conf.itemsPerPage=parseInt(localStorage[a.conf.rememberPerPage])):a.conf.itemsPerPage=parseInt(a.conf.itemsPerPage)?parseInt(a.conf.itemsPerPage):15;a.conf.numberOfPages=Math.ceil(a.conf.totalItems/a.conf.itemsPerPage);1>a.conf.currentPage&&(a.conf.currentPage=1);a.conf.currentPage>a.conf.numberOfPages&&(a.conf.currentPage=a.conf.numberOfPages);a.jumpPageNum=a.conf.currentPage;for(var c=a.conf.perPageOptions.length,d,b=0;b<c;b++)a.conf.perPageOptions[b]==a.conf.itemsPerPage&&(d=!0);d||a.conf.perPageOptions.push(a.conf.itemsPerPage);a.conf.perPageOptions.sort(function(a,b){return a-b});a.pageList=[];if(a.conf.numberOfPages<=a.conf.pagesLength)for(b=1;b<=a.conf.numberOfPages;b++)a.pageList.push(b);else{c=(a.conf.pagesLength-1)/2;if(a.conf.currentPage<=c){for(b=1;b<=c+1;b++)a.pageList.push(b);a.pageList.push("...")}else if(a.conf.currentPage>a.conf.numberOfPages-c)for(a.pageList.push(1),a.pageList.push("..."),b=c+1;1<=b;b--)a.pageList.push(a.conf.numberOfPages-b);else{a.pageList.push(1);a.pageList.push("...");for(b=Math.ceil(c/2);1<=b;b--)a.pageList.push(a.conf.currentPage-b);a.pageList.push(a.conf.currentPage);for(b=1;b<=c/2;b++)a.pageList.push(a.conf.currentPage+b);a.pageList.push("...")}a.pageList.push(a.conf.numberOfPages)}if(a.conf.onChange)a.conf.onChange();a.$parent.conf=a.conf})}}}]);